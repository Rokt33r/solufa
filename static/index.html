<script src="js/jThree.js"></script>
<script>
document.write( '<scr' + 'ipt src="http://' + location.hostname + ':35729/livereload.js?ext=Chrome&amp;extver=2.1.0"></scr' + 'ipt>' );
</script>
<script src="js/MSXTransformer.js"></script>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<script type="text/msx;harmony=true">
j3( function() {
var pos = [0,0,0];
var fn = function() {
	//pos[1]+=.005;m.redraw();
};
	setInterval( fn,50);

  var App = {
		vm: {
			geo: {
        type: "Box",
        value: [ .3, .3, .3 ]
      },
			mtl: {
        type: "MeshPhong",
        value: {
          color: "#00f",
          specular: "#fff"
        }
      },
			positions: [],
			init: function() {
	      for ( var i = 0; i < 1000; i++ ) {
	        this.positions.push([ Math.random() * 100 - 50,Math.random() * 100 - 50,Math.random() * 100 - 50]);
	      }
			}
		},
    controller: function() {
			App.vm.init();
    },
    view: function() {
      var vm = App.vm;

      return <scene>
				<mesh geo={vm.geo} mtl={vm.mtl} position={j3.s([0,0,-3])}/>
        { vm.positions.map( v => <mesh geo={vm.geo} mtl={vm.mtl} position={v}/>)}
        <obj position={j3.s(pos)}>
          <camera id="cam"/>
          <camera id="cam1"/>
        </obj>
        <light type="Dir" position={j3.s([1,10,10])}/>
      </scene>;
    }
  };


  m.mount( j3.document.body, App );
  m.render( j3.document.head, <rdr init={{ frame: "#jthree", antialias: true, preserveDrawingBuffer: false }}>
		<vp camera="#cam" width={.5} height={1} left={0} top={0}/>
		<vp camera="#cam1" width={.5} height={1} left={.5} top={0}/>
	</rdr> );
});
</script>

<style>
#jthree {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}
</style>
<div id="jthree"></div>
